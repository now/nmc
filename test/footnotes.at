AT_NMC_CHECK_TRANSFORM([Abbreviation],
[T

  Abbr¹

¹ Abbreviation for Abbreviation],
[  <title>T</title>
  <p><abbreviation for="Abbreviation">Abbr</abbreviation></p>])

AT_NMC_CHECK_FAIL_TRANSFORM([Broken footnote],
[T

  Abbr¹

¹Abbreviation for Abbreviation],
[5:3: missing ‘ ’ after “¹”])

AT_NMC_CHECK_TRANSFORM([Inline figure],
[T

  W¹

¹ For reference, see a.jpg],
[  <title>T</title>
  <p><ref title="For reference" uri="a.jpg" relation="figure">W</ref></p>])

AT_NMC_CHECK_TRANSFORM([Reference],
[T

  Abbr¹

¹ See the Wikipedia entry for “Abbreviation” at http://en.wikipedia.org/wiki/Abbreviation],
[  <title>T</title>
  <p><ref title="See the Wikipedia entry for “Abbreviation”" uri="http://en.wikipedia.org/wiki/Abbreviation">Abbr</ref></p>])

AT_NMC_CHECK_TRANSFORM([Multiple footnotes],
[T

  W₁¹⁺² W₂³³

¹ Abbreviation for 1
² 3 at 4
³³ Abbreviation for 2],
[  <title>T</title>
  <p><ref title="3" uri="4"><abbreviation for="1">W₁</abbreviation></ref> <abbreviation for="2">W₂</abbreviation></p>])

AT_NMC_CHECK_TRANSFORM([Multi-word footnote],
[T

  W₁ {W₂ W₃}¹

¹ 1 at 2],
[  <title>T</title>
  <p>W₁ <ref title="1" uri="2">W₂ W₃</ref></p>])

AT_NMC_CHECK_TRANSFORM([Section-level footnotes],
[T

§ S

    W¹

  ¹ 1 at 2],
[  <title>T</title>
  <section>
    <title>S</title>
    <p><ref title="1" uri="2">W</ref></p>
  </section>])

AT_NMC_CHECK_TRANSFORM([Footnote nesting],
[T

§ S

    W¹

¹ 1 at 2],
[  <title>T</title>
  <section>
    <title>S</title>
    <p><ref title="1" uri="2">W</ref></p>
  </section>])

AT_NMC_CHECK_TRANSFORM([Reused footnote],
[T

§ S

    W¹

  § Ss

      W¹

  ¹ 1 at 2],
[  <title>T</title>
  <section>
    <title>S</title>
    <p><ref title="1" uri="2">W</ref></p>
    <section>
      <title>Ss</title>
      <p><ref title="1" uri="2">W</ref></p>
    </section>
  </section>])

AT_NMC_CHECK_TRANSFORM([Multi-line footnote],
[T

  W¹

¹ 1 at
  2],
[  <title>T</title>
  <p><ref title="1" uri="2">W</ref></p>])

AT_NMC_CHECK_FAIL_TRANSFORM([Unrecognized footnote content],
[T

  W¹

¹ Junk text in this here footnote],
[5.1-34: unrecognized footnote content: Junk text in this here footnote])

AT_NMC_CHECK_FAIL_TRANSFORM([Repeated footnote sigil],
[T

  W¹

¹ 1 at 2
¹ 3 at 4],
[6.1-9: footnote ¹ already defined at 5.1-9])

AT_NMC_CHECK_FAIL_TRANSFORM([Unreferenced footnotes],
[T

  W

¹ 1 at 2
² 3 at 4],
[5.1-9: unreferenced footnote: ¹
6.1-9: unreferenced footnote: ²])

AT_NMC_CHECK_FAIL_TRANSFORM([Reference to undefined footnote],
[T

  W¹],
[3.4-5: reference to undefined footnote: ¹])

AT_NMC_CHECK_FAIL_TRANSFORM([Block-level Reference to undefined footnote defined later],
[T

  1¹

§ S

    2¹

¹ 1 at 2],
[3.4-5: reference to undefined footnote: ¹])

AT_NMC_CHECK_FAIL_TRANSFORM([Section-level Reference to undefined footnote defined later],
[T

§ S₁

    2¹

§ S₂

    3¹

¹ 1 at 2],
[5.6-7: reference to undefined footnote: ¹])

AT_NMC_CHECK_FAIL_TRANSFORM([Many references to undefined footnotes],
[T

§ S₁

    2¹

§ S₂

    3²],
[5.6-7: reference to undefined footnote: ¹
9.6-7: reference to undefined footnote: ²])

AT_NMC_CHECK_FAIL_TRANSFORM([Anchor without preceding node],
[T

  ¹],
[3.3-4: syntax error, unexpected ANCHOR, expecting WORD or CODE or EMPHASIS or BEGINGROUP])
